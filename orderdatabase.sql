 create database orderdatabase;
 use orderdatabase;
 CREATE TABLE CUSTOMER
(
CUST int,
CNAME CHAR(15) NOT NULL,
CITY CHAR(15),
PRIMARY KEY(CUST)
);
CREATE TABLE CUSTORDER
(
ORDE int,
ODATE DATE,
CUST INT REFERENCES CUSTOMER(CUST),
ORD_AMT INT,
PRIMARY KEY(ORDE)
);
CREATE TABLE ITEM
(
ITEM int ,
UNITPRICE INT NOT NULL,
PRIMARY KEY(ITEM)
);
CREATE TABLE ORDER_ITEM
(
ORDE INT,
ITEM INT,
QTY INT,
FOREIGN KEY(ORDE) REFERENCES CUSTORDER(ORDE),
FOREIGN KEY(ITEM) REFERENCES ITEM(ITEM),
PRIMARY KEY(ORDE,ITEM)
);
CREATE TABLE WAREHOUSE
(
WAREHOUSE INT,
CITY CHAR(15),
PRIMARY KEY(WAREHOUSE)
);
CREATE TABLE SHIPMENT
(
ORDE INT,
WAREHOUSE INT,
SHIP_DATE DATE,
FOREIGN KEY(ORDE) REFERENCES CUSTORDER(ORDE),
FOREIGN KEY(WAREHOUSE) REFERENCES
WAREHOUSE(WAREHOUSE),
PRIMARY KEY(ORDE,WAREHOUSE)
);



insert into customer values('1','ABC','Banglore'),('3','GHI','Banglore'), ('4','JKL','CHITOOR') ,('5','MNO','MYSORE') ,('2','DEF','KOLAR');


INSERT INTO CUSTORDER VALUES('1','2006-01-06',2,5000.5), ('2', '2006-04-26' ,3 ,2500 ),('3', '2006-04-27' ,3 ,1000),('4','2006-04-30', 5, 1000 ),('5', '2006-05-25', 1, 5000 );

insert into item values (1,2500),(2,5000),(3,1000),(4,5),(5,200); 

insert into order_item VALUES(1,2,1),(1,4,1),(2,1,1),(3,5,5),(4,2,2);
insert into warehouse VALUES(2,'KOLAR'),(1,'Banglore'),(3,'CHITOOR'),(4,'Manglore'),(5,'Mysore');
insert into shipment values(1,1,'2006-04-26'),(2,2,'2006-04-29'),(3,2,'2006-04-24'),(4,5,'2006-04-30'),(5,3,'2006-06-01');




SELECT C.CNAME, COUNT(*),AVG(O.ORD_AMT)
FROM CUSTOMER C, CUSTORDER O
WHERE
C.CUST=O.CUST GROUP BY C.CNAME;




SELECT DISTINCT ORDE FROM WAREHOUSE W, SHIPMENT S WHERE W.WAREHOUSE#=S.WAREHOUSE# AND CITY='BLORE';




ALTER TABLE ORDER_ITEM DROP CONSTRAINT FOREIGN KEY(ITEM);
ALTER TABLE ORDER_ITEM ADD CONSTRAINT FOREIGN KEY(ITEM)
REFERENCES ITEM(ITEM) ON DELETE SET NULL;



